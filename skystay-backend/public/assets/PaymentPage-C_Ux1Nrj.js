import{r as w,b,c as f,u as k,j as s,a as S}from"./index-QTl8ArDV.js";function I(){w.useEffect(()=>(document.body.classList.add("payment-page"),()=>{document.body.classList.remove("payment-page")}),[]);const l=b(),{state:N}=f()||{},c=k(a=>{var i,j;return((i=a.userModule)==null?void 0:i.user)||((j=a.userModule)==null?void 0:j.loggedinUser)||null}),{stay:e={},checkIn:h=null,checkOut:u=null,guests:o=1,currency:d="USD",nightlyPrice:t=0,nights:v=0}=N||{},r=Math.max(1,Number(v)||0),m=Math.round((Number(t)||0)*r*.05),x=Number(t)*r+Number(m),p=a=>a?new Date(a).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}):"",n=a=>new Intl.NumberFormat(void 0,{style:"currency",currency:d,maximumFractionDigits:2}).format(Number(a)||0),g=a=>{if(!a)return"";const i=new Date(a);return isNaN(i)?"":i.toISOString().split("T")[0]};async function y(){if(!c){l("/auth/login");return}try{await S.add({userId:c._id||c.id,stayId:e.id||e._id||"",stayName:e.name||e.title||"Stay",imgUrl:e.imgUrl||e.coverImg||e.imgs&&e.imgs[0]||"",hostFullname:e.hostFullname||e.host&&(e.host.fullname||e.host.name)||"",checkIn:g(h),checkOut:g(u),guests:o,currency:d,nightlyPrice:Number(t)||0,nights:r,serviceFee:m,totalPrice:x,status:"pending",bookedOn:Date.now(),stay:e}),l("/trips",{replace:!0}),window.location.reload()}catch{l("/trips",{replace:!0}),window.location.reload()}}return s.jsxs("section",{className:"payment-page",children:[s.jsxs("header",{className:"payment-page__title",children:[s.jsx("button",{type:"button",className:"arrow-btn",onClick:()=>{l(-1),window.location.reload()},"aria-label":"Back",children:s.jsx("svg",{className:"arrow-img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","aria-hidden":"true",role:"presentation",focusable:"false",style:{display:"block",fill:"none",height:22,width:22,stroke:"#000",strokeWidth:2.6667,overflow:"visible",transform:"scaleX(-1)"},children:s.jsx("path",{fill:"none",d:"m12 4 11.3 11.3a1 1 0 0 1 0 1.4L12 28"})})}),s.jsx("h2",{children:"Request to book"})]}),s.jsxs("main",{className:"payment-layout",children:[s.jsxs("section",{className:"order-details",children:[s.jsxs("div",{className:"trip-details",children:[s.jsx("h3",{className:"your-trip",children:"Your trip"}),s.jsxs("div",{className:"trip-row",children:[s.jsx("h4",{className:"trip-subheader",children:"Dates"}),s.jsxs("h5",{className:"trip-details-data",children:[p(h)," - ",p(u)]})]}),s.jsxs("div",{className:"trip-row",children:[s.jsx("h4",{className:"trip-subheader",children:"Guests"}),s.jsxs("h5",{className:"trip-details-data",children:[o," ",o===1?"guest":"guests"]})]})]}),s.jsx("div",{className:"order-user",children:s.jsx("button",{className:"btn-square-color_btnSquareColor__vA+xX",onClick:y,children:"Confirm"})})]}),s.jsxs("section",{className:"summary-card",children:[s.jsxs("div",{className:"stay-details flex border-buttom",children:[s.jsx("img",{className:"stay-img",src:e.imgUrl,alt:"staypreview"}),s.jsxs("div",{className:"stay-desc",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"stay-type",children:e.type||"Private room"}),s.jsx("h4",{className:"stay-name",children:e.name||e.title||"Stay"})]}),s.jsxs("div",{className:"rating-review",children:[s.jsx("span",{className:"avg-rating",children:s.jsxs("span",{className:"avg-rating",style:{display:"flex",flexWrap:"nowrap"},children:[s.jsx("span",{className:"total-avg-star",children:s.jsx("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 576 512",height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"})})}),s.jsx("span",{className:"total-avg-rating",style:{paddingLeft:4},children:e.rating||"4.77"})]})}),s.jsx("span",{className:"avg-rating-seperator",children:"â€¢"}),s.jsxs("span",{className:"reviews",children:["(5",s.jsx("span",{className:"avg-rating-reviews",children:" reviews"}),")"]})]})]})]}),s.jsxs("div",{className:"price-details",children:[s.jsx("h3",{className:"price-details-header",children:"Price details"}),s.jsxs("div",{className:"cost-breakdown",children:[s.jsxs("div",{className:"cost-details",children:[s.jsxs("div",{className:"base-cost",children:[s.jsxs("span",{className:"cost-calc",children:[n(t)," x ",r," nights"]}),s.jsx("span",{children:n(t*r)})]}),s.jsxs("div",{className:"base-cost service",children:[s.jsx("span",{className:"cost-calc",children:"Service fee"}),s.jsx("span",{children:n(m)})]})]}),s.jsx("div",{className:"total-container",children:s.jsxs("div",{className:"cost-total",children:[s.jsxs("span",{children:["Total ",s.jsxs("span",{style:{textDecoration:"underline"},children:["(",d,")"]})]}),s.jsx("span",{children:n(x)})]})})]})]})]})]})]})}export{I as default};
